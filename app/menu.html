<!doctype html>

<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Apps</title>

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0e1116;
  --card:rgba(255,255,255,.12);
  --border:rgba(255,255,255,.18);
  --text:#fff;
  --muted:#9ca3af;
  --radius:26px;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Outfit,system-ui;
  background:var(--bg);
  color:var(--text);
  overflow-x:hidden;
}

header{
  position:sticky;
  top:0;
  z-index:20;
  padding:26px 22px 18px;
  backdrop-filter:blur(28px) saturate(180%);
  background:
    linear-gradient(
      to bottom,
      rgba(14,17,22,.9),
      rgba(14,17,22,.6),
      transparent
    );
  box-shadow:0 20px 60px rgba(0,0,0,.45);
}

header h1{
  margin:0;
  font-size:26px;
  font-weight:700;
}

.section{
  padding:18px 0 26px;
}

.section-title{
  padding:0 20px 12px;
  font-size:18px;
  font-weight:600;
}

.row::-webkit-scrollbar{display:none}

.row{
  display:flex;
  gap:18px;
  padding:0 22px;
  overflow-x:auto;
  scroll-snap-type:x mandatory;
  overscroll-behavior-x:contain;
}

.app-card{
  position:relative;
  flex:0 0 170px;
  border-radius:28px;
  background:linear-gradient(
    180deg,
    rgba(255,255,255,.22),
    rgba(255,255,255,.08)
  );
  border:1px solid rgba(255,255,255,.18);
  overflow:hidden;
  transform-style:preserve-3d;
  transition:
    transform .55s cubic-bezier(.22,1,.36,1),
    box-shadow .55s ease;
}

.app-card::before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(
    120deg,
    transparent 30%,
    rgba(255,255,255,.35),
    transparent 70%
  );
  opacity:0;
  transition:opacity .4s ease;
}

@media (hover:hover){
  .app-card:hover{
    transform:translateY(-14px) scale(1.08);
    box-shadow:
      0 70px 160px rgba(0,0,0,.9),
      inset 0 1px 0 rgba(255,255,255,.35);
    z-index:5;
  }

  .app-card:hover::before{
    opacity:.45;
  }
}

.app-card:active{
  transform:scale(.96);
}

@media (hover:hover){
  .app-card:hover{
    transform:translateY(-10px) scale(1.06);
    box-shadow:
      0 50px 120px rgba(0,0,0,.8),
      0 0 0 1px rgba(255,255,255,.08);
    z-index:2;
  }
}

.app-card:active{
  transform:scale(.97);
}

.app-card:hover{
  transform:translateY(-6px) scale(1.03);
  box-shadow:0 40px 90px rgba(0,0,0,.6);
}

.app-thumb{
  height:115px;
  background-size:cover;
  background-position:center;
  transform:translateZ(30px);
  transition:transform .45s ease;
}

@media (hover:hover){
  .app-card:hover .app-thumb{
    transform:translateY(-6px) scale(1.05);
  }
}

.app-info{
  padding:14px;
}

.app-info h3{
  margin:0;
  font-size:15px;
  font-weight:600;
}

.app-info span{
  font-size:12px;
  color:var(--muted);
}

#authorView{
  position:fixed;
  inset:0;
  background:linear-gradient(
    180deg,
    rgba(14,17,22,.98),
    rgba(14,17,22,.9)
  );
  backdrop-filter:blur(40px) saturate(180%);
  z-index:200;
  display:flex;
  flex-direction:column;
  opacity:0;
  pointer-events:none;
  transform:scale(.96) translateY(30px);
  transition:
    opacity .6s ease,
    transform .7s cubic-bezier(.22,1,.36,1);
}

#authorView.show{
  opacity:1;
  transform:none;
  pointer-events:auto;
}

.author-header{
  padding:22px 20px;
  display:flex;
  align-items:center;
  gap:14px;
}

.back{
  font-size:14px;
  color:var(--muted);
  cursor:pointer;
}

.author-header h2{
  margin:0;
  font-size:22px;
}

.grid .app-card{
  flex: none;
  opacity:0;
  animation:gridIn .7s cubic-bezier(.22,1,.36,1) forwards;
}

@keyframes gridIn{
  from{
    opacity:0;
    transform:translateY(50px) scale(.92);
  }
  to{
    opacity:1;
    transform:none;
  }
}

.grid{
  padding:18px;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:18px;
}

@keyframes cardIn{
  from{
    opacity:0;
    transform:translateY(40px) scale(.95);
  }
  to{
    opacity:1;
    transform:none;
  }
}

.section{
  opacity:0;
  transform:translateY(60px);
  animation:sectionIn .9s cubic-bezier(.22,1,.36,1) forwards;
}

.section:nth-child(1){animation-delay:.1s}
.section:nth-child(2){animation-delay:.25s}
.section:nth-child(3){animation-delay:.4s}
.section:nth-child(4){animation-delay:.55s}

@keyframes sectionIn{
  to{
    opacity:1;
    transform:none;
  }
}

.cinematic-bg{
  position:fixed;
  inset:-20%;
  z-index:-1;
  background:
    radial-gradient(1200px 800px at 10% 10%, rgba(99,102,241,.25), transparent 60%),
    radial-gradient(1200px 800px at 90% 80%, rgba(236,72,153,.22), transparent 60%),
    radial-gradient(1000px 600px at 50% 50%, rgba(56,189,248,.18), transparent 65%);
  filter:blur(120px) saturate(160%);
  animation:bgFloat 40s ease-in-out infinite;
}

@keyframes bgFloat{
  0%{transform:translate(0,0)}
  50%{transform:translate(-120px,-80px)}
  100%{transform:translate(0,0)}
}
</style>

</head>

<body>
<div class="cinematic-bg"></div>

<header>
  <h1>Aplicaciones</h1>
</header>

<main id="content"></main>

<!-- AUTHOR FULL VIEW -->

<div id="authorView">
  <div class="author-header">
    <div class="back" onclick="closeAuthor()">‚Üê Volver</div>
    <h2 id="authorTitle"></h2>
  </div>
  <div class="grid" id="authorGrid"></div>
</div>

<script>
const JSON_URL = "/api/control/descarga-manager.json"
const content = document.getElementById("content")

fetch(JSON_URL + "?ts=" + Date.now())
.then(r=>r.json())
.then(data=>{
  const groups = {}

  data.apps.forEach(app=>{
    if(!groups[app.author]) groups[app.author] = []
    groups[app.author].push(app)
  })

  Object.entries(groups).forEach(([author,apps])=>{
    const section = document.createElement("section")
    section.className = "section"

    section.innerHTML = `
      <div class="section-title">${author}</div>
      <div class="row"></div>
    `

    const row = section.querySelector(".row")

    apps.forEach(app=>{
      const card = document.createElement("div")
      card.className = "app-card"
      card.innerHTML = `
        <div class="app-thumb" style="background-image:url('${app.background}')"></div>
        <div class="app-info">
          <h3>${app.title}</h3>
          <span>${app.author}</span>
        </div>
      `

      card.onclick = ()=>openAuthor(author, apps)
      row.appendChild(card)
    })

    content.appendChild(section)
  })
})

function openAuthor(author, apps){
  document.getElementById("authorTitle").textContent = author
  const grid = document.getElementById("authorGrid")
  grid.innerHTML = ""

  apps.forEach((app,i)=>{
  const card = document.createElement("div")
  card.className = "app-card"
  card.style.animationDelay = `${i * 90}ms`
  card.innerHTML = `
    <div class="app-thumb" style="background-image:url('${app.background}')"></div>
    <div class="app-info">
      <h3>${app.title}</h3>
    </div>
  `
  card.onclick = ()=>location.href = "download.html?id=" + app.id
  grid.appendChild(card)
})

  const view = document.getElementById("authorView")
  view.classList.add("show")
}

function closeAuthor(){
  const view = document.getElementById("authorView")
  view.classList.remove("show")
}

document.querySelectorAll(".row").forEach(row=>{
  row.addEventListener("scroll",()=>{
    row.querySelectorAll(".app-card").forEach(card=>{
      const rect = card.getBoundingClientRect()
      const center = window.innerWidth / 2
      const dist = Math.abs(rect.left + rect.width/2 - center)
      const scale = Math.max(.9, 1 - dist / 1200)
      card.style.transform = `scale(${scale})`
    })
  })
})
</script>

</body>
</html>

