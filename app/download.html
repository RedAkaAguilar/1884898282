<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Descarga • ZyrAkaNetwork</title>

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet">

<style>
:root{
  --bg:#0b0f1a;
  --glass:rgba(255,255,255,.18);
  --glass-strong:rgba(255,255,255,.28);
  --border:rgba(255,255,255,.22);
  --text:#fff;
  --muted:rgba(255,255,255,.65);
  --accent:#8bffe0;
  --accent-2:#6cf2ff;
  --blur:44px;
  --spring:cubic-bezier(.22,1.1,.36,1);
}

*{
  box-sizing:border-box;
  -webkit-tap-highlight-color:transparent;
}

body{
  margin:0;
  min-height:100vh;
  font-family:Outfit,system-ui;
  background:
    radial-gradient(1200px 600px at 10% 10%,#1a2440,transparent),
    radial-gradient(1000px 600px at 90% 90%,#0f3d36,transparent),
    var(--bg);
  color:var(--text);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}

/* FLOATING LIGHTS */
.lights{
  position:fixed;
  inset:-30%;
  filter:blur(180px);
  pointer-events:none;
}
.lights span{
  position:absolute;
  width:55vw;
  height:55vw;
  border-radius:50%;
  background:rgba(255,255,255,.16);
  animation:float 40s ease-in-out infinite;
}
.lights span:nth-child(1){top:6%;left:10%}
.lights span:nth-child(2){bottom:8%;right:14%;animation-duration:54s}
.lights span:nth-child(3){top:42%;right:28%;animation-duration:62s}

@keyframes float{
  0%{transform:translate(0,0) scale(1)}
  50%{transform:translate(160px,-120px) scale(1.5)}
  100%{transform:translate(0,0) scale(1)}
}

/* APP WINDOW */
.app{
  position:relative;
  z-index:1;
  width:min(860px,94vw);
  min-height:560px;
  padding:44px 48px 46px;
  border-radius:38px;
  background:
    linear-gradient(180deg,rgba(255,255,255,.45),rgba(255,255,255,.12));
  backdrop-filter:blur(var(--blur)) saturate(180%);
  border:1px solid var(--border);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.75),
    0 160px 320px rgba(0,0,0,.9);
  animation:appIn 1s var(--spring);
}

@keyframes appIn{
  from{opacity:0;transform:translateY(80px) scale(.9)}
  to{opacity:1;transform:none}
}

/* HEADER */
.header{
  max-width:520px;
  margin-bottom:28px;
}
.header h1{
  margin:0;
  font-size:28px;
  font-weight:800;
  letter-spacing:.2px;
}
.header p{
  margin:10px 0 0;
  font-size:15px;
  color:var(--muted);
  line-height:1.7;
}

/* LOADER */
.loader{
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  gap:18px;
}
.spinner{
  width:62px;
  height:62px;
  border-radius:50%;
  border:4px solid rgba(255,255,255,.25);
  border-top-color:var(--accent);
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* SECTIONS */
.section{
  margin-top:18px;
  border-radius:26px;
  background:rgba(255,255,255,.16);
  border:1px solid rgba(255,255,255,.28);
  overflow:hidden;
  animation:sectionIn .8s var(--spring) both;
}
.section:nth-child(2){animation-delay:.05s}
.section:nth-child(3){animation-delay:.1s}
.section:nth-child(4){animation-delay:.15s}

@keyframes sectionIn{
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1}
}

.section-header{
  display:flex;
  align-items:center;
  gap:14px;
  padding:20px 22px;
  cursor:pointer;
}
.section-header span{
  font-size:26px;
}
.section-header strong{
  flex:1;
  font-size:16px;
}

.recommended{
  font-size:12px;
  font-weight:700;
  padding:5px 12px;
  border-radius:999px;
  background:linear-gradient(135deg,var(--accent),var(--accent-2));
  color:#000;
}

.section-content{
  padding:0 22px 22px;
  display:none;
  animation:expand .35s ease;
}
@keyframes expand{
  from{opacity:0;transform:translateY(-8px)}
  to{opacity:1}
}
.section-content p{
  margin:14px 0 0;
  font-size:14px;
  color:rgba(255,255,255,.82);
  line-height:1.65;
  white-space:pre-line;
}

/* DOWNLOAD BUTTON */
.download{
  margin-top:18px;
  height:52px;
  border-radius:18px;
  background:linear-gradient(135deg,var(--accent),var(--accent-2));
  color:#000;
  font-weight:800;
  font-size:15px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  text-decoration:none;
  transition:transform .25s var(--spring),box-shadow .25s;
  box-shadow:0 22px 60px rgba(140,255,230,.45);
}
.download:hover{
  transform:translateY(-2px);
  box-shadow:0 30px 80px rgba(140,255,230,.65);
}
.download:active{
  transform:scale(.96);
}

/* ERROR */
.error{
  text-align:center;
}
.error span{
  font-size:64px;
  opacity:.75;
}
</style>
</head>

<body>

<div class="lights">
  <span></span><span></span><span></span>
</div>

<div id="app" class="app">
  <div class="loader">
    <div class="spinner"></div>
    <p class="header">Cargando información…</p>
  </div>
</div>

<script>
const DATA_URL='/api/control/descarga-manager.json'
const app=document.getElementById('app')
const id=new URLSearchParams(location.search).get('id')
const os=navigator.platform.toLowerCase()

function rich(t){
  return t
    .replace(/\*\*(.*?)\*\*/g,'<b>$1</b>')
    .replace(/_(.*?)_/g,'<i>$1</i>')
    .replace(/`(.*?)`/g,'<code>$1</code>')
}

function showError(title,msg){
  app.innerHTML=`
    <div class="error">
      <span class="material-symbols-rounded">error</span>
      <h1>${title}</h1>
      <p>${msg}</p>
    </div>`
}

if(!id){
  showError('Descarga no válida','No se especificó un producto.')
}else{
  fetch(DATA_URL,{cache:'no-store'})
    .then(r=>{if(!r.ok)throw 0;return r.json()})
    .then(data=>{
      const p=data.productos?.[id]
      if(!p){
        showError('Producto no encontrado','Esta descarga no existe.')
        return
      }

      app.innerHTML=`
        <div class="header">
          <h1>${p.titulo}</h1>
          <p>${rich(p.descripcion)}</p>
        </div>

        ${p.secciones.map((s,i)=>{
          const rec=
            (os.includes('win')&&s.titulo.toLowerCase().includes('windows'))||
            (os.includes('linux')&&s.titulo.toLowerCase().includes('linux'))||
            (os.includes('mac')&&s.titulo.toLowerCase().includes('mac'))

          return`
          <div class="section">
            <div class="section-header" onclick="toggle(${i})">
              <span class="material-symbols-rounded">${s.icono}</span>
              <strong>${s.titulo}</strong>
              ${rec?'<span class="recommended">Recomendado</span>':''}
            </div>
            <div class="section-content" id="sec${i}">
              <p>${rich(s.descripcion)}</p>
              <a class="download" href="${s.url}">
                <span class="material-symbols-rounded">download</span>
                Descargar
              </a>
            </div>
          </div>`
        }).join('')}
      `
    })
    .catch(()=>showError('Error de carga','No se pudo obtener la información.'))
}

function toggle(i){
  const el=document.getElementById('sec'+i)
  el.style.display=el.style.display==='block'?'none':'block'
}
</script>

</body>
</html>
